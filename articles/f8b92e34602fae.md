---
title: "WSL2ã§Cypressã‚’å‹•ã‹ã™"
emoji: "ğŸ”–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["WSL2", "Cypress"]
published: false
---

## ã¯ã˜ã‚ã«

WSL2ã§Cypressã‚’ç«‹ã¡ä¸Šã’ã‚‹ç’°å¢ƒã®ãƒ¡ãƒ¢ã€‚
ç’°å¢ƒã¯ä»¥ä¸‹ã€‚
- Ubuntu20.04
- Windows11
- nodejs@v16.6.0
- npm@v7.19.1
- cypress@10.4.0

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

WSL2ä¸Šã«Cypressã®ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒä¸è¶³ã—ã¦ã„ãŸã®ã§è¿½åŠ ã—ã¦ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

```sh
# dependencies
apt-get install libgtk2.0-0 libgtk-3-0 libgbm-dev libnotify-dev libgconf-2-4 libnss3 libxss1 libasound2 libxtst6 xauth xvfb
npm install -D cypress
```

## WSL2ã§cypressã‚’é–‹ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹

WSL2ã¯Linuxã®GUIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ã‘ãªã„ã®ã§Xã‚µãƒ¼ãƒã«ã‚ˆã£ã¦é–‹ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚  

VcXsrvã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
https://sourceforge.net/projects/vcxsrv/

~/.bashrcã®å…ˆé ­ã«ä¸‹è¨˜ã‚’è¿½è¨˜
```sh
# set DISPLAY variable to the IP automatically assigned to WSL2
export DISPLAY=$(cat /etc/resolv.conf | grep nameserver | awk '{print $2; exit;}'):0.0
```

ä¸‹è¨˜ã‚’å®Ÿè¡Œ
```sh
source ~/.bashrc
sudo /etc/init.d/dbus start &> /dev/null
```

Windowsã®æ¤œç´¢ã‹ã‚‰XLaunchã‚’èµ·å‹•ã€‚  
Display settings, Client startupã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã¾ã¾é€²ã‚€ã€‚  
Extra settingsã¯Disable access controlã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦é€²ã‚€ã€‚  
Windowsã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ©ãƒ¼ãƒˆãŒå‡ºã‚‹ãŒã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯/ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã©ã¡ã‚‰ã‚‚è¨±å¯ã€‚  

## WSL2ã«GoogleChromeã‚’è¿½åŠ ã™ã‚‹

WSL2ã«ChromeãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆã¯Cypressã®E2Eãƒ†ã‚¹ãƒˆã§Chromeã‚’ä½¿ç”¨ã§ããªã„ãŸã‚å…¥ã‚Œã‚‹ã€‚

```sh
sudo apt update && sudo apt -y upgrade && sudo apt -y autoremove
wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
sudo apt -y install ./google-chrome-stable_current_amd64.deb

# WSLä¸Šã«ChromeãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸã‹ç¢ºèª
google-chrome --version
```

## å‚è€ƒ
[Setting up the Cypress GUI in WSL2 Ubuntu for Windows 10 | Wilco van Esch](https://wilcovanes.ch/articles/setting-up-the-cypress-gui-in-wsl2-ubuntu-for-windows-10/)
[Use Google Chrome in Ubuntu on Windows Subsystem Linux Â· Scott Spence](https://scottspence.com/posts/use-chrome-in-ubuntu-wsl)
